你是个高级ai工程师，整理上面的代码，尽量不要改动源代码，不要乱写，加上main函数和注释，该打印的例子都打印出来，别乱写，我要书上的原始代码，你不要乱加代码。展示图片的时候加上d2l.plt.show()  才能展示出图片，，要加上检测设备比如时cuda还是mps的代码，我在pycham中运行，加上训练时间

，原来代码上有多少图片，你就展示多少，不要删减，直接写出完整代码，不要偷懒，忽略md格式


整理代码，保持原始不乱改，加上 main()、注释、设备检测（cuda/mps/cpu）、训练时间打印，原来有多少图片就展示多少，用 d2l.plt.show()，能运行在 PyCharm。